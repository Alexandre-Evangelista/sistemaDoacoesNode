generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  email      String      @unique
  latitude   Float?
  longitude  Float?
  foto       String?
  tipo       Boolean?
  telefone   String?
  nome       String
  cpf        String?     @unique
  cnpj       String?     @unique
  id         String      @id @default(uuid())
  senha      String
  avaliacoes Avaliacao[]
  doacoes    Doacao[]
}

model ONG {
  nome       String
  latitude   Float?
  longitude  Float?
  foto       String?
  descricao  String?
  telefone   String
  senha      String
  cnpj       String      @id @default(uuid())
  avaliacoes Avaliacao[]
  campanhas  Campanha[]
  doacoes    Doacao[]
}

model Campanha {
  descricao   String
  nome       String @default("Campanha de doação")
  foto        String
  latitude    Float?
  longitude   Float?
  datacriacao DateTime @default(now())
  cnpjOng     String?
  id          String   @id @default(uuid())
  ong         ONG?     @relation(fields: [cnpjOng], references: [cnpj])
  doacoes     Doacao[]
}

model Doacao {
  datadoacao DateTime
  quantidade Int
  tipo       String
  email      String?
  cnpj       String?
  IDcampanha String?
  id         String    @id @default(uuid())
  campanha   Campanha? @relation(fields: [IDcampanha], references: [id])
  ong        ONG?      @relation(fields: [cnpj], references: [cnpj])
  usuario    Usuario?  @relation(fields: [email], references: [email])
}

model Avaliacao {
  emailUsuario String
  cnpj         String
  feedback     String
  id           String  @id @default(uuid())
  ong          ONG     @relation(fields: [cnpj], references: [cnpj])
  usuario      Usuario @relation(fields: [emailUsuario], references: [email])

  @@unique([emailUsuario, cnpj])
}
